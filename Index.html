<!doctype html>
<html lang="en">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5671620912564469"
     crossorigin="anonymous"></script>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dog Life Cost Planner (Beta)</title>
  <meta name="description" content="Plan the lifetime costs of your dog — monthly cashflow, year-by-year journey, and lifetime total." />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f7f7fb; --text:#111; --muted:#666; --card:#fff; --line:#e9e9f2;
      --brand:#4f46e5; --brand-2:#7c3aed;
    }
    *{box-sizing:border-box}
    body{font-family:"Inter",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:var(--bg);color:var(--text);-webkit-font-smoothing:antialiased}
    .wrap{max-width:920px;margin:0 auto;padding:24px}
    header{padding:18px 0;margin-bottom:8px}
    h1{margin:0 0 8px}
    .hero{
      background:linear-gradient(135deg,var(--brand) 0%,var(--brand-2) 100%);
      color:#fff;border-radius:14px;padding:18px 16px;margin:12px 0;
      box-shadow:0 8px 24px rgba(79,70,229,.25)
    }
    .card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:16px;margin:14px 0;box-shadow:0 6px 16px rgba(16,24,40,.06)}
    label{display:block;margin:8px 0 6px;font-weight:600}
    select,input,button,a.button{width:100%;padding:12px 12px;border:1px solid #ddd;border-radius:10px;background:#fff}
    input[type="number"]{appearance:textfield}
    button{cursor:pointer;background:var(--brand);color:#fff;border:0;font-weight:600}
    button:hover{filter:brightness(1.05)}
    a.button{background:#fff;text-decoration:none;text-align:center}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .stats{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    .stat{background:#fbfbff;border:1px solid var(--line);border-radius:12px;padding:12px;text-align:center}
    .big{font-size:22px;font-weight:700}
    .muted{color:var(--muted)}
    #chart{width:100%;height:280px;display:block}
    .aff-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:8px}
    .aff{background:#fff;border:1px dashed #cfd3ff;border-radius:12px;padding:12px;text-align:center}
    .aff a{display:block;margin-top:8px;background:#eef2ff;border:0}
    .aff a:hover{filter:brightness(1.05)}
    .extras-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:8px}
    .extras-grid .aff{border-style:solid}
    @media (max-width:760px){.grid,.stats,.aff-grid,.extras-grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="hero">
      <h1>Dog Life Cost Planner <span class="muted" style="color:#eaeaff">/ Beta</span></h1>
      <p style="margin:6px 0 0">Plan every stage of your dog’s journey — month by month, year by year.</p>
    </div>
  </header>

  <!-- Maddie image card -->
  <div class="card" style="padding:0; overflow:hidden; border-radius:14px; text-align:center">
    <img src="./IMG_0742.jpeg" alt="Maddie the dog"
         style="width:100%; height:auto; display:block; aspect-ratio:16/9; object-fit:cover;">
    <div style="padding:10px" class="muted">Maddie — CEO • Best dog ever • Fastest dog in the South West</div>
  </div>

  <div class="card">
    <div class="grid">
      <div>
        <label>Breed</label>
        <select id="breed"></select>
      </div>
      <div>
        <label>Lifestyle</label>
        <select id="tier">
          <option>Standard</option>
          <option>Premium</option>
        </select>
      </div>
      <div>
        <label>Insurance</label>
        <select id="insurance">
          <option>Yes</option>
          <option>No</option>
        </select>
      </div>
      <div>
        <label>Region</label>
        <select id="region">
          <option>Rest of UK</option>
          <option>London/Urban</option>
        </select>
      </div>

      <!-- NEW: Current Age -->
      <div>
        <label>Current Age</label>
        <select id="currentAge"></select>
      </div>

      <!-- NEW: Weight -->
      <div>
        <label>Weight (kg)</label>
        <input type="number" id="weight" min="2" max="90" step="0.1" placeholder="e.g. 25">
      </div>
    </div>
    <p class="muted" style="margin:8px 0 0">
      Broad beta model. We’ll refine with UK sources (PDSA, RSPCA, PFMA, insurers) and real owner inputs.
    </p>
    <button id="calc" style="margin-top:12px">Calculate</button>
  </div>

  <div class="card">
    <h3>Your Results</h3>
    <div class="stats">
      <div class="stat"><div class="muted">Monthly Avg</div><div id="monthly" class="big">–</div></div>
      <div class="stat"><div class="muted">Lifetime Total</div><div id="lifetime" class="big">–</div></div>
      <div class="stat"><div class="muted">Year-1 (next 12m)</div><div id="year1" class="big">–</div></div>
    </div>
    <canvas id="chart" aria-label="Yearly cashflow" role="img"></canvas>
    <p id="emote" style="margin-top:8px"></p>
    <p class="muted" id="assumptionNote"></p>

    <!-- RESCUE LINKS -->
    <div style="background:#fdf6f6; border:1px solid #f5c2c2; border-radius:12px; padding:12px; margin:16px 0;">
      <h4 style="margin:4px 0 8px">Thinking of adopting?</h4>
      <p class="muted" style="margin:0 0 8px">Every year thousands of dogs in the UK need a loving home.</p>
      <ul style="margin:0 0 8px 18px">
        <li><a href="https://www.rspca.org.uk/findapet" target="_blank" rel="noopener">RSPCA — Find a Pet</a></li>
        <li><a href="https://www.dogsblog.com/" target="_blank" rel="noopener">DogsBlog.com — UK shelters</a></li>
        <li><a href="https://www.battersea.org.uk/dogs" target="_blank" rel="noopener">Battersea Dogs & Cats Home</a></li>
        <li><a href="https://www.pets4homes.co.uk/adoption/dogs/near-me/united-kingdom/england/north-somerset/weston-super-mare/" target="_blank" rel="noopener">Pets4Homes — Weston-super-Mare</a></li>
        <li><a href="https://www.rspca.org.uk/local/north-somerset-branch/findapet" target="_blank" rel="noopener">RSPCA — North Somerset</a></li>
      </ul>
      <p class="muted" style="margin:0">Change a dog's life.</p>
    </div>

    <p class="muted" id="disclosure">
      Some links are affiliate links. If you buy through them, we may earn a commission at no extra cost to you.
    </p>

    <!-- Core affiliates -->
    <div class="aff-grid">
      <div class="aff">
        <div>Compare dog insurance for your breed</div>
        <a id="insLink" class="button" href="https://www.quotezone.co.uk/SetAffiliate.php?aid=F1W7T6-009&type=pet" target="_blank" rel="sponsored nofollow">Get insurance quotes →</a>
        <p class="muted" style="margin-top:6px; font-size:13px; line-height:1.3;">
  Pet insurance comparison is provided by Quotezone (Seopa Ltd), authorised and regulated by the FCA (FRN 313860).
      </div>
      <div class="aff">
        <div>Premium food picks for your dog</div>
        <a id="foodLink" class="button" href="#"
           target="_blank" rel="sponsored nofollow">Premium food picks →</a>
      </div>
    </div>

    <!-- Recommended extras -->
    <h4 style="margin:16px 0 6px">Recommended extras</h4>
    <div class="extras-grid">
      <div class="aff">
        <div>Best Dog Beds</div>
        <a class="button" target="_blank" rel="sponsored nofollow"
           href="https://www.amazon.co.uk/s?k=best+orthopedic+dog+bed&i=pets&tag=cp33086503-21">
           Shop Beds →
        </a>
      </div>
      <div class="aff">
        <div>Best Outdoor Kennels</div>
        <a class="button" target="_blank" rel="sponsored nofollow"
           href="https://www.amazon.co.uk/s?k=best+outdoor+dog+kennel&i=pets&tag=cp33086503-21">
           View Kennels →
        </a>
      </div>
      <div class="aff">
        <div>Best Automatic Feeders</div>
        <a class="button" target="_blank" rel="sponsored nofollow"
           href="https://www.amazon.co.uk/s?k=best+automatic+dog+feeder&i=pets&tag=cp33086503-21">
           Explore Feeders →
        </a>
      </div>
      <div class="aff">
        <div>Best Leads & Collars</div>
        <a class="button" target="_blank" rel="sponsored nofollow"
           href="https://www.amazon.co.uk/s?k=best+dog+lead+collar&i=pets&tag=cp33086503-21">
           Find Leads →
        </a>
      </div>
    </div>

    <button id="pdfBtn" style="margin-top:12px">Download personalised PDF</button>
  </div>

  <div class="card">
    <h4>Notes & next steps</h4>
    <ul>
      <li>We show first-year setup spikes, steady middle years, and higher senior-year vet costs.</li>
      <li>Food link adapts by breed size or entered weight + lifestyle; insurance coming soon.</li>
    </ul>
  </div>
</div>

<!-- jsPDF for client-side PDF generation -->
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

<script>
// ====== Breed "database" (inline; add/edit freely) ======
const DOGS = {
  "German Shepherd":   { size:"large",  years:14, baseFood:1000, premFood:1200, routineVet:800, seniorExtra:1200, groom:300, trainY1:1000, suppliesY1:400, supplies:200, purchaseY1:2000, insureStd:650, insurePrem:900 },
  "Labrador Retriever":{ size:"large",  years:13, baseFood:950,  premFood:1100, routineVet:700, seniorExtra:900,  groom:280, trainY1:800,  suppliesY1:350, supplies:200, purchaseY1:1500, insureStd:600, insurePrem:850 },
  "Golden Retriever":  { size:"large",  years:12, baseFood:950,  premFood:1150, routineVet:800, seniorExtra:1000, groom:320, trainY1:900,  suppliesY1:350, supplies:200, purchaseY1:1800, insureStd:650, insurePrem:900 },
  "French Bulldog":    { size:"small",  years:11, baseFood:650,  premFood:750,  routineVet:900, seniorExtra:1000, groom:250, trainY1:400,  suppliesY1:300, supplies:150, purchaseY1:2000, insureStd:800, insurePrem:1000 },
  "Dachshund":         { size:"small",  years:14, baseFood:500,  premFood:600,  routineVet:700, seniorExtra:800,  groom:220, trainY1:500,  suppliesY1:300, supplies:150, purchaseY1:1200, insureStd:500, insurePrem:700 },
  "Cockapoo":          { size:"medium", years:13, baseFood:700,  premFood:850,  routineVet:700, seniorExtra:900,  groom:420, trainY1:600,  suppliesY1:320, supplies:180, purchaseY1:1600, insureStd:550, insurePrem:750 },
  "Cocker Spaniel":    { size:"medium", years:13, baseFood:750,  premFood:900,  routineVet:700, seniorExtra:900,  groom:380, trainY1:700,  suppliesY1:320, supplies:180, purchaseY1:1400, insureStd:580, insurePrem:780 },
  "Border Collie":     { size:"medium", years:14, baseFood:800,  premFood:950,  routineVet:700, seniorExtra:900,  groom:260, trainY1:800,  suppliesY1:320, supplies:180, purchaseY1:1300, insureStd:560, insurePrem:760 },
  "Staffordshire Bull Terrier": { size:"medium", years:12, baseFood:750, premFood:900, routineVet:750, seniorExtra:900, groom:250, trainY1:600, suppliesY1:300, supplies:170, purchaseY1:1200, insureStd:600, insurePrem:800 },
  "Cavalier King Charles Spaniel": { size:"small", years:12, baseFood:600, premFood:720, routineVet:800, seniorExtra:900, groom:300, trainY1:600, suppliesY1:300, supplies:150, purchaseY1:1400, insureStd:650, insurePrem:850 },
  "Shih Tzu":          { size:"small",  years:14, baseFood:550,  premFood:660,  routineVet:700, seniorExtra:800,  groom:420, trainY1:500,  suppliesY1:280, supplies:150, purchaseY1:1100, insureStd:520, insurePrem:700 },
  "Pug":               { size:"small",  years:12, baseFood:600,  premFood:720,  routineVet:800, seniorExtra:900,  groom:240, trainY1:500,  suppliesY1:280, supplies:150, purchaseY1:1200, insureStd:650, insurePrem:850 },
  "Beagle":            { size:"medium", years:13, baseFood:750,  premFood:900,  routineVet:700, seniorExtra:900,  groom:260, trainY1:700,  suppliesY1:320, supplies:180, purchaseY1:1300, insureStd:560, insurePrem:760 },
  "Boxer":             { size:"large",  years:11, baseFood:900,  premFood:1080, routineVet:800, seniorExtra:1100, groom:280, trainY1:800,  suppliesY1:350, supplies:200, purchaseY1:1700, insureStd:700, insurePrem:950 },
  "Rottweiler":        { size:"large",  years:10, baseFood:1100, premFood:1300, routineVet:900, seniorExtra:1200, groom:300, trainY1:900,  suppliesY1:380, supplies:220, purchaseY1:2000, insureStd:800, insurePrem:1100 },
  "Poodle (Standard)": { size:"large",  years:13, baseFood:900,  premFood:1080, routineVet:800, seniorExtra:1000, groom:520, trainY1:800,  suppliesY1:350, supplies:200, purchaseY1:1800, insureStd:620, insurePrem:850 },
  "Poodle (Miniature)":{ size:"small",  years:14, baseFood:600,  premFood:720,  routineVet:700, seniorExtra:800,  groom:480, trainY1:600,  suppliesY1:300, supplies:160, purchaseY1:1400, insureStd:520, insurePrem:700 },
  "Yorkshire Terrier": { size:"small",  years:14, baseFood:520,  premFood:640,  routineVet:700, seniorExtra:800,  groom:420, trainY1:500,  suppliesY1:260, supplies:140, purchaseY1:1100, insureStd:500, insurePrem:680 },
  "Chihuahua":         { size:"small",  years:14, baseFood:480,  premFood:600,  routineVet:650, seniorExtra:750,  groom:220, trainY1:500,  suppliesY1:240, supplies:130, purchaseY1:1000, insureStd:480, insurePrem:650 },
  "English Springer Spaniel": { size:"medium", years:13, baseFood:800, premFood:960, routineVet:700, seniorExtra:900, groom:360, trainY1:700, suppliesY1:320, supplies:180, purchaseY1:1400, insureStd:580, insurePrem:780 },
  "Labradoodle":       { size:"large",  years:13, baseFood:900,  premFood:1080, routineVet:750, seniorExtra:950,  groom:500, trainY1:800,  suppliesY1:340, supplies:190, purchaseY1:1800, insureStd:600, insurePrem:820 },
  "Cavapoo":           { size:"small",  years:13, baseFood:620,  premFood:740,  routineVet:700, seniorExtra:850,  groom:460, trainY1:650,  suppliesY1:300, supplies:160, purchaseY1:1600, insureStd:520, insurePrem:720 },
  "Mixed/Rescue (Medium)": { size:"medium", years:13, baseFood:720, premFood:860, routineVet:700, seniorExtra:900, groom:300, trainY1:600, suppliesY1:300, supplies:170, purchaseY1:250, insureStd:550, insurePrem:750 }
};

// ====== Helpers & model ======
const $ = sel => document.querySelector(sel);

function fmt(n){ return "£" + Math.round(n).toLocaleString(); }

// Weight → annual food (£/yr) for Standard; Premium adds ~15%
function annualFoodFromWeight(weightKg, tier){
  const w = Number(weightKg);
  if(!w || w <= 0) return null;
  let monthly;
  if (w < 10) monthly = 40;
  else if (w < 25) monthly = 60;
  else if (w < 40) monthly = 80;
  else monthly = 100;
  if (tier === "Premium") monthly *= 1.15;
  return monthly * 12;
}

// Weight → size label for Amazon search
function sizeFromWeight(weightKg){
  const w = Number(weightKg);
  if(!w || w <= 0) return null;
  if (w < 10) return "small";
  if (w < 25) return "medium";
  if (w < 40) return "large";
  return "large"; // treat >40kg as large for query
}

function model(breed, tier, insurance, region, currentAgeYears, weightKg){
  const p = DOGS[breed];
  const years = p.years;
  const startAge = Math.max(0, Math.min(years, Number(currentAgeYears)||0)); // clamp
  const remainingYears = Math.max(0, years - startAge);

  // Food: weight override if provided, else breed defaults
  const weightFood = annualFoodFromWeight(weightKg, tier);
  const baseFoodAnnual = weightFood ?? (tier === "Premium" ? p.premFood : p.baseFood);

  const regionalFood = baseFoodAnnual * (region.includes("London") ? 1.08 : 1.0);
  const insure = insurance === "Yes"
      ? (tier==="Premium" ? p.insurePrem : p.insureStd) * (region.includes("London") ? 1.10 : 1.0)
      : 0;
  const groom = p.groom * (tier==="Premium" ? 1.1 : 1.0);
  const routineVet = p.routineVet * (region.includes("London") ? 1.10 : 1.0);

  const rows = [];
  // Loop actual dog age from next birthday onward (remaining horizon)
  for(let i=1; i<=remainingYears; i++){
    const ageThisYear = startAge + i; // 1..remaining mapped to real age
    const isFirstYearOutput = (i===1);

    // Vet costs with senior bump near the end
    let vet = routineVet;
    if(ageThisYear >= Math.max(10, years-4)) vet += p.seniorExtra;

    // One-off costs only if starting from puppy (age 0) and it's the first output year
    const purchase = (startAge===0 && isFirstYearOutput) ? p.purchaseY1 : 0;
    const training = (startAge===0 && isFirstYearOutput) ? p.trainY1 : 0;

    // Supplies: Y1 spike only if starting from puppy; plus annual supplies each year
    const supplies = ((startAge===0 && isFirstYearOutput) ? p.suppliesY1 : 0) + p.supplies;

    // Annual food already adjusted
    const total = purchase + training + supplies + regionalFood + insure + vet + groom;
    rows.push({year:i, age:ageThisYear, total});
  }
  return rows;
}

// Populate controls
const breedEl = $('#breed'), tierEl = $('#tier'), insEl = $('#insurance'), regionEl = $('#region');
const ageEl = $('#currentAge'), weightEl = $('#weight');

(function populateBreeds(){
  const breeds = Object.keys(DOGS);
  breeds.forEach(name=>{
    const opt = document.createElement('option');
    opt.textContent = name;
    breedEl.appendChild(opt);
  });
  const idx = breeds.indexOf("German Shepherd");
  if(idx>=0) breedEl.selectedIndex = idx;
})();

(function populateAges(){
  for(let y=0; y<=15; y++){
    const opt = document.createElement('option');
    opt.value = String(y);
    opt.textContent = y===0 ? 'Puppy (0 years)' : `${y} year${y>1?'s':''}`;
    ageEl.appendChild(opt);
  }
  ageEl.value = "0";
})();

// ===== Dynamic Amazon food link (uses weight size if present, else breed size) =====
const AMAZON_TAG = "cp33086503-21";
const AMAZON_FALLBACK = "https://amzn.to/4oZAwmh";

function amazonFoodSearchUrl(breed, tier, weightKg){
  const weightSize = sizeFromWeight(weightKg);
  const size = weightSize || DOGS[breed]?.size || "medium";
  const sizePhrase = size==="large" ? "large breed" : size==="small" ? "small breed" : "medium breed";
  const premium = (tier === "Premium") ? "premium " : "";
  const bagHint = size==="large" ? "12kg" : (size==="small" ? "2kg" : "7kg");
  const query = `${premium}${sizePhrase} dry dog food ${bagHint}`;
  if (!AMAZON_TAG) return AMAZON_FALLBACK;
  return `https://www.amazon.co.uk/s?k=${encodeURIComponent(query)}&i=pets&tag=${AMAZON_TAG}`;
}

function updateFoodLink(){
  const href = amazonFoodSearchUrl(breedEl.value, tierEl.value, weightEl.value);
  $('#foodLink').href = href;
}

// ---- Assumption note ----
function updateAssumptionNote(breed, tier, weightKg){
  const p = DOGS[breed];
  const weightFood = annualFoodFromWeight(weightKg, tier);
  const annualFood = weightFood ?? (tier === "Premium" ? p.premFood : p.baseFood);
  const monthlyFood = Math.round(annualFood / 12);
  const basis = weightFood ? `${weightKg}kg` : breed;
  document.getElementById('assumptionNote').textContent =
    `Food assumption: about £${monthlyFood}/month (${tier.toLowerCase()} — based on ${basis}).`;
}

// -------- Chart --------
function drawChart(totals){
  const c = document.getElementById('chart');
  const ctx = c.getContext('2d');
  const cssW = c.clientWidth, cssH = c.clientHeight;
  const scale = window.devicePixelRatio || 1;
  c.width = Math.round(cssW * scale);
  c.height = Math.round(cssH * scale);
  ctx.setTransform(1,0,0,1,0,0);
  ctx.clearRect(0,0,c.width,c.height);
  ctx.scale(scale, scale);

  const padL = 48, padB = 34, padT = 16, padR = 12;
  const max = Math.max(...totals, 1);
  const min = 0;
  const plotW = cssW - padL - padR;
  const plotH = cssH - padT - padB;
  const X = i => padL + (plotW) * (i/(totals.length-1 || 1));
  const Y = v => (padT + plotH) - (plotH) * ((v - min) / (max - min || 1));

  // axes
  ctx.strokeStyle = "#444"; ctx.lineWidth = 1;
  ctx.beginPath();
  ctx.moveTo(padL, padT);
  ctx.lineTo(padL, padT + plotH);
  ctx.lineTo(padL + plotW, padT + plotH);
  ctx.stroke();

  // grid + y labels
  ctx.fillStyle = "#444"; ctx.font = "12px Inter, system-ui, sans-serif";
  const steps = 5;
  for(let i=0;i<=steps;i++){
    const val = min + (max-min) * (i/steps);
    const y = Y(val);
    ctx.textAlign = "right"; ctx.textBaseline = "middle";
    ctx.fillText("£"+Math.round(val/100)*100, padL - 6, y);
    ctx.strokeStyle="#e9e9f2"; ctx.lineWidth=1;
    ctx.beginPath(); ctx.moveTo(padL, y); ctx.lineTo(padL + plotW, y); ctx.stroke();
  }
  // x labels = Remaining Yr N
  ctx.textAlign = "center"; ctx.textBaseline = "top";
  totals.forEach((_,i)=>{ if(i%2===0 || i===totals.length-1){ ctx.fillText("Rem Yr "+(i+1), X(i), padT+plotH+6); } });

  // line
  ctx.strokeStyle="#4f46e5"; ctx.lineWidth=2;
  ctx.beginPath();
  totals.forEach((v,i)=>{ const x=X(i), y=Y(v); i?ctx.lineTo(x,y):ctx.moveTo(x,y); });
  ctx.stroke();
}

function recalc(){
  const currentAge = Number(ageEl.value||0);
  const weightKg = Number(weightEl.value||0);

  const rows = model(breedEl.value, tierEl.value, insEl.value, regionEl.value, currentAge, weightKg);
  const totals = rows.map(r=>r.total);
  const lifetime = totals.reduce((a,b)=>a+b,0);
  const monthly = rows.length > 0 ? lifetime / (rows.length * 12) : 0;
  const year1 = totals[0] ?? 0;

  $('#monthly').textContent  = fmt(monthly);
  $('#lifetime').textContent = fmt(lifetime);
  $('#year1').textContent    = rows.length ? fmt(year1) : "–";

  drawChart(totals);

  $('#emote').textContent =
    rows.length
      ? "Spending pattern reflects your dog's current age and weight. Expect higher costs in senior years (vet care)."
      : "Looks like your dog may already be at or beyond the typical lifespan for this breed.";

  updateFoodLink();
  updateAssumptionNote(breedEl.value, tierEl.value, weightEl.value);
}

document.getElementById('calc').addEventListener('click', recalc);
window.addEventListener('resize', ()=>recalc());
recalc();
updateFoodLink();
updateAssumptionNote(breedEl.value, tierEl.value, weightEl.value);

// ====== PDF generation ======
document.getElementById('pdfBtn').addEventListener('click', async () => {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({ unit: 'pt', format: 'a4' });

  const breed   = document.getElementById('breed').value;
  const tier    = document.getElementById('tier').value;
  const region  = document.getElementById('region').value;
  const insure  = document.getElementById('insurance').value;
  const age     = document.getElementById('currentAge').value;
  const weight  = document.getElementById('weight').value || "—";
  const monthly = document.getElementById('monthly').textContent;
  const lifetime= document.getElementById('lifetime').textContent;
  const year1   = document.getElementById('year1').textContent;

  doc.setFont('helvetica','bold'); doc.setFontSize(20);
  doc.text('Dog Life Cost Planner — Personalised Summary', 40, 44);
  doc.setDrawColor(230); doc.line(40, 54, 555, 54);

  doc.setFont('helvetica','normal'); doc.setFontSize(12);
  let y = 76;
  const lines = [
    `Breed: ${breed}`,
    `Lifestyle: ${tier}`,
    `Region: ${region}`,
    `Insurance: ${insure}`,
    `Current age: ${age} year(s)`,
    `Weight: ${weight} kg`,
    `Monthly average: ${monthly}`,
    `Remaining lifetime total: ${lifetime}`,
    `Next-12-months estimate: ${year1}`,
    '',
    'Notes:',
    '— Year 1 shows the next 12 months from current age.',
    '— Senior years include higher vet care.',
    '— Food cost adjusts by weight if provided.'
  ];
  lines.forEach(l => { doc.text(l, 40, y); y += 18; });

  const canvas = document.getElementById('chart');
  if (canvas && canvas.toDataURL) {
    const imgData = canvas.toDataURL('image/png', 1.0);
    doc.addImage(imgData, 'PNG', 40, y + 10, 515, 260);
  }

  doc.setFontSize(10); doc.setTextColor(120);
  doc.text('Some links may be affiliate links. We may earn a commission at no extra cost to you.', 40, 810);

  doc.save(`DogPlanner_${breed.replace(/\s+/g,'')}.pdf`);
});
</script>
</body>
</html>